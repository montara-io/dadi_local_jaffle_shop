version: 2
models:
  - name: test
    description: test desc
    config:
      materialized: incremental
      incremental_strategy: append
      post_hook:
        - "{% if True == False %}

          \     {% if target.name == dev %}

          \        \"DELETE FROM {{ this }} WHERE last_updated < DATEADD(day,
          -{# START_stagingDataRetentionDays #}180{#
          END_stagingDataRetentionDays #}, CURRENT_DATE())\"

          \     \ 

          \    {% elif target.name == prod %}

          \      \"DELETE FROM {{ this }} WHERE last_updated < DATEADD(day, -{#
          START_productionDataRetentionDays #}30{#
          END_productionDataRetentionDays #}, CURRENT_DATE())\"

          \   \ 

          \    {% endif %}

          \  "
    tests: []
    columns:
      - name: created_at
        type: TIMESTAMP
        tests: []
      - name: name
        type: TEXT
        tests: []
      - name: is_superhost
        type: TEXT
        tests: []
      - name: updated_at
        type: TIMESTAMP
        tests: []
      - name: id
        type: NUMBER
        tests: []
    meta:
      model_tags:
        - 1f9a9e04-9372-4923-8253-be425f9420b0
      incremental_column: created_at
      data_retention_days:
        staging: 180
        production: 30
