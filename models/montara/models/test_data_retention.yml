version: 2
models:
  - name: test_data_retention
    description: ""
    config:
      materialized: incremental
      incremental_strategy: append
      post_hook:
        - "

          \ \ 

          \  {% if target.name == 'dev' %}

          \    {{log('Running retention policy for {{this}}. Staging retention
          days: 30, Production retention days: 180.')}}

          \    DELETE FROM {{this}} WHERE updated_at < DATEADD(day, -30,
          CURRENT_DATE())

          \ \ 

          \  {% elif target.name == 'prod' %}

          \    {{log('Running retention policy for {{this}}. Staging retention
          days: 30, Production retention days: 180.')}}

          \    DELETE FROM {{this}} WHERE updated_at < DATEADD(day, -180,
          CURRENT_DATE())

          \ \ 

          \  {% endif %}

          \  "
    tests: []
    columns:
      - name: created_at
        type: TIMESTAMP
        tests: []
      - name: id
        type: NUMBER
        tests:
          - not_null_tolerance:
              tolerance: 0
      - name: name
        type: TEXT
        tests: []
      - name: updated_at
        type: TIMESTAMP
        tests: []
      - name: is_superhost
        type: TEXT
        tests: []
    meta:
      model_tags: []
      incremental_column: updated_at
      data_retention_days:
        staging: 30
        production: 180
