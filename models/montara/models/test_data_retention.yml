version: 2
models:
  - name: test_data_retention
    description: ""
    config:
      materialized: incremental
      incremental_strategy: append
      post_hook:
        - "

          \  {% if True == False %}

          \  log('Running retention policy for {{ this }}'. Staging retention
          days: 180, Production retention days: 30.

          \ \ 

          \  {% elif target.name == dev %}

          \    \"DELETE FROM {{ this }} WHERE last_updated < DATEADD(day, -{#
          START_stagingDataRetentionDays #}180{# END_stagingDataRetentionDays
          #}, CURRENT_DATE())\"

          \ \ 

          \  {% elif target.name == prod %}

          \    \"DELETE FROM {{ this }} WHERE last_updated < DATEADD(day, -{#
          START_productionDataRetentionDays #}30{#
          END_productionDataRetentionDays #}, CURRENT_DATE())\"

          \ \ 

          \  {% endif %}

          \  "
    tests: []
    columns:
      - name: created_at
        type: TIMESTAMP
        tests: []
      - name: id
        type: NUMBER
        tests: []
      - name: name
        type: TEXT
        tests: []
      - name: updated_at
        type: TIMESTAMP
        tests: []
      - name: is_superhost
        type: TEXT
        tests: []
    meta:
      model_tags: []
      incremental_column: updated_at
      data_retention_days:
        staging: 180
        production: 30
